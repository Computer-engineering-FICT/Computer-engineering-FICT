<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ru" lang="ru" dir="ltr">
  
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<head>

    
<link rel="shortcut icon" href="BrightnessTool.getBrightnessMatrix_files/favicon0.ico" type="image/x-icon">
    <title>Откуда берется формула Y = 0.3R + 0.59G + 0.11B для преобразования из цветного RGB-изображения в черно-белое (монохромное)? | Компьютерная Графика и Мультимедиа</title>
    <link type="text/css" rel="stylesheet" media="all" href="BrightnessTool.getBrightnessMatrix_files/css_17f8.css">
<link type="text/css" rel="stylesheet" media="print" href="BrightnessTool.getBrightnessMatrix_files/css_6ff8.css">
    <script type="text/javascript" src="BrightnessTool.getBrightnessMatrix_files/js_37d95.js"></script>
<script type="text/javascript">
<!--//--><![CDATA[//><!--
jQuery.extend(Drupal.settings, { "basePath": "/" });
//--><!]]>
</script>
    <!--[if lt IE 7]>
      <link type="text/css" rel="stylesheet" media="all" href="/themes/garland/fix-ie.css" />    <![endif]-->
  </head>
  <body class="sidebar-left">

<!-- Layout -->
  <div id="header-region" class="clear-block"></div>

    <div id="wrapper">
    <div id="container" class="clear-block">

      <div id="header">
        <div id="logo-floater">
        <h1><a href="http://cgm.computergraphics.ru/" title="Компьютерная Графика и Мультимедиа Сетевой журнал"><img src="BrightnessTool.getBrightnessMatrix_files/logo0000.gif" alt="Компьютерная Графика и Мультимедиа Сетевой журнал" id="logo"><span>Компьютерная Графика и Мультимедиа</span> Сетевой журнал</a></h1>        </div>

                  <ul class="links primary-links"><li class="menu-48 first"><a href="http://cgm.computergraphics.ru/issues">Выпуски</a></li>
<li class="menu-60"><a href="http://cgm.computergraphics.ru/blog">Блоги</a></li>
<li class="menu-61"><a href="http://forum.graphicon.ru/">Форум</a></li>
<li class="menu-62"><a href="http://cgm.computergraphics.ru/about">О журнале</a></li>
<li class="menu-63"><a href="http://cgm.computergraphics.ru/submit">Прислать статью</a></li>
<li class="menu-78 last"><a href="http://cgm.computergraphics.ru/user/login">Вход для авторов</a></li>
</ul>                                  
      </div> <!-- /header -->

              <div id="sidebar-left" class="sidebar">
          <div class="block block-theme"><form action="http://cgm.computergraphics.ru/node/2203" accept-charset="UTF-8" method="post" id="search-theme-form">
<div><div id="search" class="container-inline">
  <div class="form-item" id="edit-search-theme-form-1-wrapper">
 <label for="edit-search-theme-form-1">Поиск на сайте: </label>
 <input type="text" maxlength="128" name="search_theme_form" id="edit-search-theme-form-1" size="15" value title="Введите слова, которые вы хотите искать." class="form-text">
</div>
<input type="submit" name="op" id="edit-submit" value="Поиск" class="form-submit">
<input type="hidden" name="form_build_id" id="form-3da40419f3d3f59841641eadc83215b2" value="form-3da40419f3d3f59841641eadc83215b2">
<input type="hidden" name="form_id" id="edit-search-theme-form" value="search_theme_form">
</div>

</div></form>
</div>          <div id="block-menu-menu---------------" class="clear-block block block-menu">

  <h2>Разделы</h2>

  <div class="content"><ul class="menu"><li class="leaf first"><a href="http://cgm.computergraphics.ru/sections/news">Новости</a></li>
<li class="leaf"><a href="http://cgm.computergraphics.ru/sections/3dgraphics">3D-графика</a></li>
<li class="leaf"><a href="http://cgm.computergraphics.ru/sections/video">Видео</a></li>
<li class="leaf"><a href="http://cgm.computergraphics.ru/sections/sound">Звук</a></li>
<li class="leaf"><a href="http://cgm.computergraphics.ru/sections/bookshelf">Книжная полка</a></li>
<li class="leaf"><a href="http://cgm.computergraphics.ru/sections/math">Математические методы</a></li>
<li class="leaf"><a href="http://cgm.computergraphics.ru/sections/computervision">Машинное зрение</a></li>
<li class="leaf"><a href="http://cgm.computergraphics.ru/sections/imageprocessing">Обработка изображений</a></li>
<li class="leaf"><a href="http://cgm.computergraphics.ru/sections/education">Образование</a></li>
<li class="leaf last"><a href="http://cgm.computergraphics.ru/sections/programming">Программирование</a></li>
</ul></div>
</div>
<div id="block-block-1" class="clear-block block block-block">


  <div class="content"><script type="text/javascript">new Image().src = "http://counter.yadro.ru/hit?r" + escape(document.referrer) + ((typeof(screen)=="undefined")?"" : ";s"+screen.width+"*"+screen.height+"*" + (screen.colorDepth?screen.colorDepth:screen.pixelDepth)) + ";u"+escape(document.URL) +  ";" +Math.random();</script>
<script language="JavaScript"> 
   1&lt;!--
   2d=document;a='';a+=';r='+escape(d.referrer)
   3js=10//-->
   </script><script language="JavaScript1.1"> 
   </script><script language="JavaScript1.2"> 
   1&lt;!--
   2s=screen;a+=';s='+s.width+'*'+s.height
   3a+=';d='+(s.colorDepth?s.colorDepth:s.pixelDepth)
   4js=12//-->
   </script><script language="JavaScript1.3"> 
   1&lt;!--
   2js=13//-->
   </script><script language="JavaScript"> 
   1&lt;!--
   2d.write('<a href="http://top.mail.ru/jump?from=28096"'+
   3' target=_top><img src="http://top.list.ru/counter'+
   4'?id=28096;t=134;js='+js+a+';rand='+Math.random()+
   5'" alt="Ð ÐµÐ¹Ñ‚Ð¸Ð½Ð³@Mail.ru"'+' border=0 height=40 width=88 /></a>')
   6if(js>11)d.write('&lt;'+'!-- ')//-->
   </script><p><a href="http://top.mail.ru/jump?from=28096" target="_top">     <img width="88" height="40" border="0" src="BrightnessTool.getBrightnessMatrix_files/counter0.gif" alt="Ð ÐµÐ¹Ñ‚Ð¸Ð½Ð³@Mail.ru">     </a>     <a href="http://top100.rambler.ru/top100/">     <img width="88" height="31" border="0" src="BrightnessTool.getBrightnessMatrix_files/banner-8.gif" alt="Rambler's Top100">     </a></p>

<!-- Yandex.Metrika -->
<script src="BrightnessTool.getBrightnessMatrix_files/watch000.js" type="text/javascript"></script>
<div style="display:none;"><script type="text/javascript">
try { var yaCounter1181346 = new Ya.Metrika(1181346); } catch(e){}
</script></div>
<noscript><div style="position:absolute"><img src="//mc.yandex.ru/watch/1181346" alt></div></noscript>
<!-- /Yandex.Metrika --></div>
</div>
        </div>
      
      <div id="center"><div id="squeeze"><div class="right-corner"><div class="left-corner">
          <div class="breadcrumb"><a href="http://cgm.computergraphics.ru/">Главная</a> › <a href="http://cgm.computergraphics.ru/blog">Блоги</a> › <a href="http://cgm.computergraphics.ru/blog/1">Алексей Игнатенко's blog</a></div>                              <h2>Откуда берется формула Y = 0.3R + 0.59G + 0.11B для преобразования из цветного RGB-изображения в черно-белое (монохромное)?</h2>                                                  <div class="clear-block">
            <div id="node-2203" class="node">



      <span class="submitted">Февраль 6, 2010 - 22:49 — Алексей Игнатенко</span>
  
  <div class="content clear-block">
    
<p>Любое цветовое пространство RGB должно быть связано с эталонным цветовым пространством CIE XYZ [4]. Для CIE XYZ известно соответствие между значением коэффициентов (x,y,z) пикселя и фактическим значением яркости эталонных источников света, смешением которых добиваются получения нужного воспринимаемого цвета. Для каждого RGB-изображения явно или неявно такое преобразование в XYZ должно быть определено, иначе оно может быть корректно показано только на том мониторе, на котором создавалось. Назовем такую информацию цветовым профилем изображения [2, 6]. Если такой профиль есть у монитора, то путем преобразования RGB<sub>image</sub> → XY Z<sub>image</sub> и затем преобразования XY Z<sub>image</sub> → RGB<sub>display</sub> монитора можно получить на другом мониторе цвета, соответствующие исходным (с учетом ограниченной цветопередачи). </p> 
    <p>В системе XYZ координата Y по определению соответствует воспринимаемой яркости цвета (Luminance [9]). Таким образом, чтобы получить из RGB монохромное изображение с учетом воспринимаемых человеком яркостей, необходимо преобразовать каждый пиксель в XYZ и взять координату Y в качестве результата. Известно, что преобразование между любыми аддитивными цветовыми системами линейное (в силу линейности восприятия цвета целовеком [7]), а, значит, может быть описано матрицей M<sub>3×3</sub>, такой, что </p> 
    <p align="center"><img border="0" width="141" height="55" src="BrightnessTool.getBrightnessMatrix_files/image001.png"></p> 
    <p>Коэффициенты (0.3,0.59,0.11) — это округленная до второго знака строчка из матрицы преобразования M<sub>NTSC</sub> из системы NTSC RGB (стандарт для американского телевидения) в XYZ, а “типичная” формула </p>
 <table border="0" cellpadding="0">
  <tr>
   <td> 
    <p align="center"><img border="0" width="180" height="12" src="BrightnessTool.getBrightnessMatrix_files/image002.png"></p>
   </td>
   <td> 
    <p>(1)</p>
   </td>
  </tr>
 </table> 
    <p>вычисляет воспринимаемую яркость Y для изображения, закодированного в NTSC RGB. Полная матрица преобразования выглядит так[1]: </p> 
    <p align="center"><img border="0" width="337" height="55" src="BrightnessTool.getBrightnessMatrix_files/image003.png"></p> 
    <p>Большинство цифровых изображений на данный момент соответствуют стандарту sRGB [3,5], разработанному для компьютерных мониторов, поэтому типичная формула неверна! </p> 
    <p>Более корректным будет преобразование для sRGB (см. матрицу M<sub>sRGB</sub> в [1]): Y = 0.21R + 0.72G + 0.07B . Но наиболее правильным будет использование профиля изображения, если он доступен. </p> 
    <p>Необходимо обратить внимание, что RGB-изображения имеют нелинейную кодировку яркости, так называемую гамма-коррекцию [8] C<sub>gamma</sub> = C<sub>linear</sub><sup>1∕</sup><sub>γ</sub>, где γ является также частью профиля изображения (для sRGB можно считать гамму равной 2.2, хотя на практике функция несколько сложнее [3, 5]). А преобразование в черно-белое необходимо проводить в линейном пространстве, поэтому перед преобразованием надо выполнить гамма-преобразование, обратное гамма-коррекции C<sub>linear</sub> = C<sub>gamma</sub><sup>γ</sup>. Таким образом, корректное преобразование из цветного sRGB-изображения в монохромное выглядит так (цвета изображения лежат в диапазоне [0,255]): </p> 
    <p align="center"><img border="0" width="390" height="87" src="BrightnessTool.getBrightnessMatrix_files/image004.png"></p> 
    <p>Как видно из рисунка 1, разница между преобразованиями (1) и (2) имеется и она может быть существенной для требовательных приложений. </p>
 <table border="0" cellspacing="0" cellpadding="0">
  <tr>
   <td valign="bottom"> 
    <p align="center"><img border="0" width="99" height="151" src="BrightnessTool.getBrightnessMatrix_files/image005.png"></p>
   </td>
   <td valign="bottom"> 
    <p align="center"><img border="0" width="99" height="150" src="BrightnessTool.getBrightnessMatrix_files/image006.png"></p>
   </td>
   <td valign="bottom"> 
    <p align="center"><img border="0" width="99" height="150" src="BrightnessTool.getBrightnessMatrix_files/image007.png"></p>
   </td>
   <td valign="bottom"> 
    <p align="center"><img border="0" width="99" height="150" src="BrightnessTool.getBrightnessMatrix_files/image008.png"></p>
   </td>
  </tr>
  <tr>
   <td valign="bottom"> 
    <p align="center">(а) </p>
   </td>
   <td valign="bottom"> 
    <p align="center">(б) </p>
   </td>
   <td valign="bottom"> 
    <p align="center">(в) </p>
   </td>
   <td valign="bottom"> 
    <p align="center">(г) </p>
   </td>
  </tr>
  <tr>
   <td valign="bottom">
   </td>
   <td valign="bottom">
   </td>
   <td valign="bottom">
   </td>
   <td valign="bottom">
   </td>
  </tr>
 </table> 
    <p>Рис. 1: Пример преобразование цветного в черно-белое изображение. (а) Исходное изображение (б) “Типичное” неверное преобразование (в) sRGB-преобразование (г) Линейная разница (x15)</p> 
    <p><b>Ссылки</b></p> 
    <p>[1] <a href="http://www.brucelindbloom.com/index.html?Eqn_RGB_XYZ_Matrix.html">http://www.brucelindbloom.com/index.html?Eqn_RGB_XYZ_Matrix.html</a> </p> 
    <p>[2] <a href="http://www.color.org/">http://www.color.org</a> </p> 
    <p>[3] <a href="http://www.w3.org/Graphics/Color/sRGB.html">http://www.w3.org/Graphics/Color/sRGB.html</a> </p> 
    <p>[4] <a href="http://en.wikipedia.org/wiki/CIE_1931_color_space">http://en.wikipedia.org/wiki/CIE_1931_color_space</a> </p> 
    <p>[5] <a href="http://en.wikipedia.org/wiki/SRGB">http://en.wikipedia.org/wiki/SRGB</a> </p> 
    <p>[6] <a href="http://en.wikipedia.org/wiki/ICC_profile">http://en.wikipedia.org/wiki/ICC_profile</a> </p> 
    <p>[7] <a href="http://en.wikipedia.org/wiki/Grassmann's_law_(optics)">http://en.wikipedia.org/wiki/Grassmann%27s_law_%28optics%29</a> </p> 
    <p>[8] <a href="http://en.wikipedia.org/wiki/Gamma_correction">http://en.wikipedia.org/wiki/Gamma_correction</a> </p> 
    <p>[9] <a href="http://en.wikipedia.org/wiki/Luminance_(relative)">http://en.wikipedia.org/wiki/Luminance_%28relative%29</a></p><table id="attachments" class="sticky-enabled">
 <thead><tr><th>Прикрепленный файл</th><th>Размер</th> </tr></thead>
<tbody>
 <tr class="odd"><td><a href="http://www.cgm.computergraphics.ru/files/cgm/rgb2gray_article.pdf">rgb2gray_article.pdf</a></td><td>419.46 кб </td> </tr>
</tbody>
</table>
  </div>

  <div class="clear-block">
    <div class="meta">
        </div>

          <div class="links"><ul class="links inline"><li class="blog_usernames_blog first"><a href="http://cgm.computergraphics.ru/blog/1" title="Прочитать последние записи в блоге пользователя Алексей Игнатенко.">Блог пользователя Алексей Игнатенко</a></li>
<li class="comment_forbidden"><span><a href="http://cgm.computergraphics.ru/user/login?destination=comment%2Freply%2F2203%23comment-form">Войдите на сайт</a> для отправки комментариев</span></li>
<li class="statistics_counter last"><span>10005 просмотров</span></li>
</ul></div>
      </div>

</div>
<div id="comments">
  <h2 class="comments">Комментарии</h2><a id="comment-1712"></a>
<div class="comment comment-published odd">

  <div class="clear-block">
      <span class="submitted">May 17, 2012 - 08:51 — Гость</span>
  
  
  <div class="picture">
  </div>

    <h3><a href="http://cgm.computergraphics.ru/node/2203#comment-1712" class="active">что за ересь? (r+g+b)/3</a></h3>

    <div class="content">
      <p>что за ересь? (r+g+b)/3</p>
          </div>
  </div>

      <div class="links"><ul class="links"><li class="comment_forbidden first last"><span><a href="http://cgm.computergraphics.ru/user/login?destination=comment%2Freply%2F2203%23comment-form">Войдите на сайт</a> для отправки комментариев</span></li>
</ul></div>
  </div>
<div class="indented"><a id="comment-1718"></a>
<div class="comment comment-published even">

  <div class="clear-block">
      <span class="submitted">July 1, 2012 - 23:18 — Гость</span>
  
  
  <div class="picture">
  </div>

    <h3><a href="http://cgm.computergraphics.ru/node/2203#comment-1718" class="active">Только в идеальном мире, где</a></h3>

    <div class="content">
      <p>Только в идеальном мире, где у людей идеальные глаза и светит идеальное солнце, так что все цвета воспринимаются одинаково хорошо.</p>
          </div>
  </div>

      <div class="links"><ul class="links"><li class="comment_forbidden first last"><span><a href="http://cgm.computergraphics.ru/user/login?destination=comment%2Freply%2F2203%23comment-form">Войдите на сайт</a> для отправки комментариев</span></li>
</ul></div>
  </div>
</div></div>
          </div>
                    <div id="footer">(c) <a href="http://graphics.cs.msu.ru/">Graphics &amp; Media lab</a> (<a href="mailto:cgm@computergraphics.ru">cgm@computergraphics.ru</a>)<br>
При использовании материалов в сети Интернет или бумажной прессе ссылка на сайт (<a href="http://cgm.computergraphics.ru/">http://cgm.computergraphics.ru</a>) строго обязательна.</div>
      </div></div></div></div> <!-- /.left-corner, /.right-corner, /#squeeze, /#center -->

      
    </div> <!-- /container -->
  </div>
<!-- /layout -->

    </body>
</html>

<!-- This document saved from http://cgm.computergraphics.ru/node/2203 -->
